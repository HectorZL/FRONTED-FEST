<div class="min-h-screen bg-gray-50 font-poppins flex flex-col lg:flex-row">
  <!-- Sidebar Overlay para m贸vil -->
  <div 
    *ngIf="!isCollapsed" 
    class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40"
    (click)="toggleSidebar()">
  </div>

  <!-- Sidebar -->
  <aside 
    [class]="`
      fixed lg:sticky lg:top-0
      ${isCollapsed ? 'w-20' : 'w-80'} 
      transform transition-all duration-300 ease-in-out
      h-screen bg-gradient-to-b from-gray-900 to-gray-800 
      text-white z-50 lg:z-auto
      ${isCollapsed ? '-translate-x-full lg:translate-x-0' : 'translate-x-0'}
      flex flex-col
    `">
    
    <!-- Logo Section -->
    <div class="p-6 border-b border-gray-700 flex items-center justify-between flex-shrink-0">
      <div class="flex items-center space-x-3 min-w-0">
        <span class="text-2xl"></span>
        <span 
          *ngIf="!isCollapsed" 
          class="text-xl font-bold truncate transition-opacity duration-300">
          CineAdmin
        </span>
      </div>
      
      <button 
        (click)="toggleSidebar()"
        class="lg:hidden p-2 rounded-lg hover:bg-gray-700 transition-colors"
        title="Cerrar men煤">
        <span class="material-icons text-white">close</span>
      </button>
    </div>

    <!-- Navigation Menu -->
    <nav class="flex-1 py-4">
      <ul class="space-y-2 px-4">
        <li *ngFor="let item of menuItems">
          <a 
            [routerLink]="item.path" 
            routerLinkActive="active"
            [title]="item.description"
            class="
              flex items-center space-x-3 px-4 py-3 rounded-xl
              transition-all duration-200 group relative
              hover:bg-gray-700 hover:translate-x-1
              text-gray-300 hover:text-white
            "
            [class.active]="false">
            
            <span class="text-xl flex-shrink-0">{{ item.icon }}</span>
            
            <span 
              *ngIf="!isCollapsed"
              class="font-medium transition-opacity duration-300">
              {{ item.label }}
            </span>
            
            <!-- Tooltip para modo colapsado -->
            <div 
              *ngIf="isCollapsed"
              class="
                absolute left-full ml-4 px-3 py-2 
                bg-gray-900 text-white text-sm rounded-lg
                opacity-0 invisible group-hover:opacity-100 
                group-hover:visible transition-all duration-200
                whitespace-nowrap z-50 shadow-xl
                before:content-[''] before:absolute before:right-full
                before:border-8 before:border-transparent 
                before:border-r-gray-900
              ">
              {{ item.label }}
              <div class="text-xs text-gray-400 mt-1">{{ item.description }}</div>
            </div>
          </a>
        </li>
      </ul>
    </nav>

    <!-- Contenedor inferior fijo -->
    <div class="flex-shrink-0 mt-auto">
      
      <!-- User Profile -->
      <div *ngIf="!isCollapsed && currentUser" class="p-4 border-t border-gray-700">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center font-semibold text-white">
            {{ getUserInitials() }}
          </div>
          <div class="min-w-0 flex-1">
            <p class="font-semibold text-sm truncate">{{ currentUser.nombres }} {{ currentUser.apellidos }}</p>
            <p class="text-xs text-gray-400 truncate">{{ currentUser.rol?.nombre || 'Administrador' }}</p>
            <p class="text-xs text-gray-500 truncate">{{ currentUser.email }}</p>
          </div>
        </div>
      </div>

      <!-- User Profile Colapsado -->
      <div *ngIf="isCollapsed && currentUser" class="p-2 border-t border-gray-700">
        <div class="flex justify-center">
          <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-semibold text-white text-sm">
            {{ getUserInitials() }}
          </div>
        </div>
      </div>

      <!-- SOLO UN Bot贸n toggle para desktop -->
      <div class="p-4 border-t border-gray-700">
        <button 
          (click)="toggleSidebar()"
          class="
            w-full flex items-center justify-center space-x-2 
            px-4 py-2 rounded-lg bg-gray-700 
            hover:bg-gray-600 transition-colors
            text-sm font-medium
          "
          [title]="isCollapsed ? 'Expandir men煤' : 'Contraer men煤'">
          <span class="material-icons text-lg">
            {{ isCollapsed ? 'chevron_right' : 'chevron_left' }}
          </span>
          <span *ngIf="!isCollapsed">Contraer men煤</span>
        </button>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main 
    [class]="`
      flex-1 min-h-screen transition-all duration-300 ease-in-out 
      flex flex-col 
    `">
    
    <!-- Header - Fijo en la parte superior -->
    <header class="bg-white shadow-sm border-b border-gray-200 flex-shrink-0">
      <div class="px-6 py-4">
        <div class="flex items-center justify-between">
          <div class="flex-1 lg:flex-none">
            <h1 class="text-2xl font-bold text-gray-900">Dashboard</h1>
            <p class="text-gray-600 mt-1">Sistema de Gesti贸n Cinematogr谩fica</p>
          </div>

          <div class="flex items-center space-x-3">
            <!-- User Info -->
            <div class="hidden md:flex items-center space-x-3 bg-gray-50 rounded-lg px-3 py-2">
              <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-semibold text-white text-sm">
                {{ getUserInitials() }}
              </div>
              <div class="text-right">
                <p class="text-sm font-medium text-gray-900">
                  {{ currentUser?.nombres }} {{ currentUser?.apellidos }}
                </p>
                <p class="text-xs text-gray-500">
                  {{ currentUser?.rol?.nombre || 'Administrador' }}
                </p>
              </div>
            </div>

            <!-- Notifications -->
            <button 
              class="
                relative p-2 rounded-lg hover:bg-gray-100 
                transition-colors text-gray-600
              "
              title="Notificaciones">
              <span class="material-icons">notifications</span>
              <span class="
                absolute -top-1 -right-1 w-5 h-5 
                bg-red-500 text-white text-xs 
                rounded-full flex items-center justify-center
                font-semibold
              ">3</span>
            </button>

            <!-- Settings -->
            <button 
              class="
                p-2 rounded-lg hover:bg-gray-100 
                transition-colors text-gray-600
              "
              title="Configuraci贸n">
              <span class="material-icons">settings</span>
            </button>

            <!-- Logout Button in Header -->
            <button 
              (click)="logout()"
              class="
                flex items-center space-x-1 p-2 
                rounded-lg hover:bg-red-50 
                transition-colors text-red-600
              "
              title="Cerrar sesi贸n">
              <span class="material-icons">logout</span>
              <span class="hidden sm:block text-sm font-medium">Salir</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Router Outlet - Contenido expansible -->
    <div class="flex-1 p-6 overflow-auto">
      <router-outlet></router-outlet>
    </div>
  </main>
</div>